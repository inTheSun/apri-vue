/**
* vue-memory-router v0.0.1
*/
function getComponentName(t){return t&&(t.Ctor.options.name||t.tag)}function removeItem(t,e){if(!isArray(t)||!t.length)return!1;for(var n=0,o=t.length;n<o;n++)if(t[n]===e)return t.splice(n,1)}function getParentTransition(t){for(;t=t.parent;)if("transition"===t.componentOptions.tag)return t;return null}var arr=["Number","String","Function","Array","Object","Date","Boolean"];function clearCacheItem(t,e,n,o){var r=t[e];!r||o&&r.tag===o.tag||r.componentInstance.$destroy(),t[e]=null,removeItem(n,e)}arr.forEach(function(t,e){var n;n="[object "+t+"]",window["is"+t]=function(t){return Object.prototype.toString.call(t)===n}});var MemoryRouterComponent=function(t){return{name:"memoryRouter",abstract:!0,props:{max:[String,Number]},computed:{},data:function(){return{isRepaint:!1}},watch:{},deactivated:function(){this.isRepaint=!0},created:function(){this.cache=Object.create(null),this.keys=[],this.maxInt=Math.min(Math.max(parseInt(this.max)||6,6),20)},destroyed:function(){for(var t in this.cache)clearCacheItem(this.cache,t,this.keys)},render:function(t){if(this.isRepaint&&this.$vnode.data.keepAlive)return this.isRepaint=!1,null;var e=void 0,n=getParentTransition(this.$vnode);if(n&&(e=n.componentInstance)&&"out-in"===e.mode&&e._leaving)return null;var o=this.$slots.default,r=null;if(isArray(o)){var a=(r=o.find(function(t){if(isObject(t)&&(isObject(t.componentOptions)||t.isComment&&t.asyncFactory))return!0}))&&r.componentOptions;if(a){getComponentName(a);var i=this.cache,c=this.keys,s=(null==r.key?a.Ctor.cid+(a.tag?"::"+a.tag:""):r.key)+"-pageKey-"+(history.state&&history.state.key);i[s]?(console.log("use cache!"),r.componentInstance=i[s].componentInstance,removeItem(c,s),c.push(s)):(console.log("add cache!"),i[s]=r,c.push(s),this.maxInt&&c.length>this.maxInt&&(console.log("limit cache!"),clearCacheItem(i,c[0],c,this._vnode))),r.data.keepAlive=!0}}return r||o&&o[0]}}},index={install:function(t){t.component("memoryRouter",MemoryRouterComponent())}};export default index;